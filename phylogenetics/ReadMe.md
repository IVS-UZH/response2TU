# ReadMe for the response to the phylogenetic aspects of Tarasov & Uyeda's 2019 Technical Comment on the Balsi *et al.* (2019) paper in *Science*

We started from the T&U `RevBayes` and `R` scripts (kindly shared with us), as we produced the following:

  - directory `code` contains all the code needed to run the analyses reported here:
  
    - `make_trees_Rev.R` is an `R` script that prepares the trees (including the MCC consensus) for processing by `RevBayes`
  
    - `LD_models.Rev`, `compute_ancestral_states.Rev` and `compute_marginal_likelihood.Rev` are `RevBayes` scripts that implement all the paramerised phylogenetic models we tested (including the original T&U model; see the script itself for explanations and examples of use), the estimation of ancestral states, and the computation of marginal likelihoods (where possible), respectively;
    
    - `run_template.sh`, `run_XXX.sh`: the `Bash` scripts for running particular models for each tree independently
    
    - `run_template_mcc.sh`, `run_XXX_mcc_Y.sh`: the `Bash` scripts for running particular models for the MCC consensus trees
    
    - running the models sampling from the whole sample of trees can be done from within `RevBayes` as documented in the `LD_models.Rev` script itself
    
    - `analyze-results.Rmd` is an `Rmarkdown` script that analyses the results and produces the `HTML` full analysis report (please note that this file has been compressed with `XZ` as it is too big for GitHub and it is now named `analyze-results.html.xz` and **must be decompressed** to be readable by a web browser)
    
  - directory `data` contains all the required data (trees and observed values -- please note that due to file size constraints, 4 files have been individually compressed with `XZ` and **must be decompressed** before use: `indoeuropean-B-10k-matched.nex.xz`, `indoeuropean-B.tre.xz`, `indoeuropean-C-20k-matched.nex.xz` and `indoeuropean-C.tre.xz`)
  
  - directory `output` contains all the data generated by running the `RevBayes` scripts for the various models; please note that, to save space, the `.log` and `_ans_states.txt` files were individually compressed using `xz` and are read as such from `R`
  
  - directory `tutorials` contsins the original `m_DPP_bears.Rev` script that probably is the inspiration for the T&U model.
